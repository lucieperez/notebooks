# Load packages
library(bayesrules)
library(tidyverse)
library(bayesplot)
library(rstanarm)
library(janitor)
library(tidybayes)
library(broom.mixed)
data(airbnb)
nrow(airbnb)
# Number of neighborhoods & other summaries
airbnb %>%
# Number of neighborhoods & other summaries
airbnb %>%
summarize(nlevels(neighborhood), min(price), max(price))
airbnb %>%
summarize(nlevels(neighborhood), min(price), max(price))
nlevels(neighborhood) min(price) max(price)
# Number of listings
nrow(airbnb)
[1] 1561
# Number of listings
nrow(airbnb)
# Number of neighborhoods & other summaries
airbnb %>%
summarize(nlevels(neighborhood), min(price), max(price))
ggplot(airbnb, aes(x = price)) +
geom_histogram(color = "white", breaks = seq(0, 500, by = 20))
ggplot(airbnb, aes(x = log(price))) +
geom_histogram(color = "white", binwidth = 0.5)
ggplot(airbnb, aes(y = log(price), x = bedrooms)) +
geom_jitter()
ggplot(airbnb, aes(y = log(price), x = rating)) +
geom_jitter()
ggplot(airbnb, aes(y = log(price), x = room_type)) +
geom_boxplot()
ggplot(airbnb, aes(y = log(price), x = neighborhood)) +
geom_boxplot() +
scale_x_discrete(labels = c(1:44))
airbnb_model_1 <- stan_glmer(
log(price) ~ bedrooms + rating + room_type + (1 | neighborhood),
data = airbnb, family = gaussian,
prior_intercept = normal(4.6, 2.5, autoscale = TRUE),
prior = normal(0, 2.5, autoscale = TRUE),
prior_aux = exponential(1, autoscale = TRUE),
prior_covariance = decov(reg = 1, conc = 1, shape = 1, scale = 1),
chains = 4, iter = 5000*2, seed = 84735
)
prior_summary(airbnb_model_1)
pp_check(airbnb_model_1) +
labs(title = "airbnb_model_1 of log(price)") +
xlab("log(price)")
airbnb %>%
select(price, neighborhood, bedrooms, rating, room_type) %>%
head(3)
airbnb %>%
select(price, neighborhood, walk_score, transit_score) %>%
head(3)
# Calculate mean log(price) by neighborhood
nbhd_features <- airbnb %>%
group_by(neighborhood, walk_score) %>%
summarize(mean_log_price = mean(log(price)), n_listings = n()) %>%
ungroup()
# Plot mean log(price) vs walkability
ggplot(nbhd_features, aes(y = mean_log_price, x = walk_score)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE)
View(airbnb)
data(airbnb)
library(broom.mixed)
# Load packages
library(bayesrules)
library(tidyverse)
library(bayesplot)
library(rstanarm)
library(janitor)
library(tidybayes)
library(broom.mixed)
data(airbnb)
# Number of listing
nrow(airbnb)
airbnb %>%
summarize(nlevels(neighborhood), min(price), max(price))
ggplot(airbnb, aes(x = price)) +
geom_histogram(color = "white", breaks = seq(0, 500, by = 200))
ggplot(airbnb, aes(x = price)) +
geom_histogram(color = "white", breaks = seq(0, 500, by = 20))
ggplot(airbnb, aes(x = log(price))) +
geom_histogram(color = "white", binwidth = 0.5)
chains = 4, iter = 5000*2, seed = 84735
airbnb_model_1 <- stan_glmer(
log(price) ~ bedrooms + rating + room_type + (1 | neighborhood),
data = airbnb, family = gaussian,
prior_intercept = normal(4.6, 2.5, autoscale = TRUE),
prior = normal(0, 2.5, autoscale = TRUE),
prior_aux = exponential(1, autoscale = TRUE),
prior_covariance = decov(reg = 1, conc = 1, shape = 1, scale = 1),
chains = 4, iter = 5000*2, seed = 84735
)
prior_summary(airbnb_model_1)
pp_check(airbnb_model_1) +
labs(title = "airbnb_model_1 of log (price)") +
xlab("log(price)")
pp_check(airbnb_model_1) +
labs(title = "original model of price (unlogged") +
xlabs("price")
pp_check(airbnb_model_1) +
labs(title = "original model of price (unlogged") +
xlab("price")
pp_check(airbnb_model_1) +
labs(title = "original model of price (unlogged)") +
xlab("price")
